---
date: "2023-03-21T21:42:21+00:00"
title: "Unauthenticated Blind SSRF in WordPress Core: A Vulnerability Overview"
---

WordPress is one of the most popular Content Management Systems (CMS) in the world, powering over 40% of all websites on the internet. Its widespread use makes it a prime target for attackers, who are constantly looking for vulnerabilities to exploit.

In recent years, a number of security issues have been discovered in WordPress, including a serious vulnerability known as **Unauthenticated Blind SSRF**. In this post, we take a closer look at this issue.

## What Is Unauthenticated Blind SSRF?

Unauthenticated Blind SSRF (Server-Side Request Forgery) is a vulnerability that allows an attacker to send arbitrary HTTP requests from a vulnerable server, bypassing authentication and potentially accessing internal network resources.

SSRF vulnerabilities occur when an application allows an attacker to specify the URL of a resource that the application will fetch, but does not validate the input or properly restrict which network resources can be accessed.

The *blind* aspect of this vulnerability refers to the fact that the attacker cannot see the response from the request, as it is not returned to the user. This makes exploitation more difficult, as attackers must rely on indirect techniques to determine whether the request was successful.

## How Does It Work in WordPress Core?

The vulnerability was caused by insufficient input validation in the WordPress HTTP API, specifically in the `wp_http_validate_url` function.

This function is responsible for validating URLs before they are used in HTTP requests. However, it failed to properly validate URLs using the `file://` protocol. As a result, an attacker could craft a URL that referenced a local file on the server and use it to access internal resources.

For example:

```text
http://example.com/wp-admin/admin-ajax.php?action=example&url=file:///etc/passwd
```

When passed to the `wp_remote_get` function, this request would attempt to access the local file `/etc/passwd`, which may contain sensitive system information such as user account details.

## Discovery and Release of the Patch

The vulnerability was discovered by security researchers **Dawid Golunski** and **Fredric Landqvist** in December 2020.

They responsibly disclosed the issue to the WordPress security team, who addressed it in the **WordPress 5.6.1** security release on **January 13, 2021**.

Keeping WordPress installations up to date with the latest security patches is critical to protecting against vulnerabilities of this nature.

## Conclusion

To further mitigate the risk of SSRF attacks, website owners and developers should follow these best practices:

- **Avoid accepting arbitrary URLs as input:** Restrict accepted URLs to trusted domains or use allowlists.
- **Perform strict input validation:** Ensure user input conforms to expected formats and patterns.
- **Use proper authentication and authorization:** Enforce strong access controls to prevent unauthorized resource access.
- **Implement network segmentation:** Limit internal network exposure to only necessary services.

Prevention is always better than cure.

---

## References

- <https://nvd.nist.gov/vuln/detail/CVE-2022-3590>
- <https://www.sonarsource.com/blog/wordpress-core-unauthenticated-blind-ssrf/>
